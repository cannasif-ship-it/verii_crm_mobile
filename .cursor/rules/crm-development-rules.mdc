---
description: CRM Expo Cursor Rules — senior, Android-safe, single source of truth
alwaysApply: true
---

# CRM Expo Cursor Rules
React Native + Expo + TypeScript

Bu dosya projedeki TEK ve KESİN kural setidir.
Cursor bu kurallara uymayan kod üretmemelidir.

================================================================================
## 0) KIRMIZI ÇİZGİLER (ASLA YAPMA)

- Comment satırı yazma
- any kullanma (unknown + type guard)
- Component veya Screen içinde fetch/axios çağrısı yapma
- Feature dışından feature içi dosyaya direkt import yapma
- ScrollView ile dinamik/uzun liste render etme
- ScrollView + map kullanma
- Büyük listede inline renderItem yazma
- Form state’ini useState ile yönetme
- Hardcoded string yazma
- God screen / god component yazma
- Screen içinde business logic yazma

================================================================================
## 1) PROJE MİMARİSİ (FEATURE FIRST — ZORUNLU)

src/
  app/
    (auth)/
    (tabs)/
    _layout.tsx
  features/
    <feature>/
      api/
      hooks/
      screens/
      components/
      types/
      utils/
      index.ts
  components/
    ui/
  lib/
    axios.ts
    queryClient.ts
    storage.ts
  store/
    ui.ts
  locales/
    tr.json
    en.json
  constants/
    env.ts

Kurallar:
- Feature’a dışarıdan erişim sadece index.ts ile
- Feature içindeki her şey aynı feature klasöründe yaşar
- Ortak UI sadece components/ui altındadır
- Feature’a özel UI feature/components altındadır

================================================================================
## 2) SCREEN / HOOK / API AYRIMI (KATI)

Screen:
- Sadece UI composition yapar
- Hook çağırır
- Query, mutation, pagination, form, navigation içermez

Hook:
- Tüm business logic
- Navigation
- Query / mutation
- Pagination
- Form + validation

API Service:
- Sadece HTTP çağrısı
- State veya logic içermez

Akış:
Screen → Hook → Query/Mutation → Service → API

================================================================================
## 3) UI STANDARDI

- UI library: Gluestack UI v3
- Gluestack componentleri sadece @/components/ui üzerinden import edilir
- components/ui sadece presentational’dır
- Yeni component eklemek için: npx gluestack-ui add <name>

================================================================================
## 4) DATA FETCHING (TANSTACK QUERY — ZORUNLU)

- Query/mutation sadece hook’larda tanımlanır
- Her query’de staleTime açıkça yazılır
- Query key standardı: ["feature", "entity", params]
- Component içinde queryClient kullanımı yasaktır

================================================================================
## 5) API / SERVICE STANDARDI

- Axios sadece src/lib/axios.ts üzerinden kullanılır
- Service saf HTTP katmanıdır
- DTO ve response tipleri feature/types altındadır

Pagination response standardı:

type PagedResponse<T> = {
  items: T[];
  page: number;
  pageSize: number;
  total?: number;
  nextPage?: number | null;
};

================================================================================
## 6) FORM STANDARDI

- react-hook-form + zod zorunlu
- useState ile form yönetimi yasak
- Validation screen içinde yazılmaz
- Submit handler hook içindedir

================================================================================
## 7) LİSTELEME (ANDROID SAFE — ZORUNLU)

- RecyclerView karşılığı: FlashList / FlatList
- ScrollView sadece kısa ve statik içerik için
- Uzun/dinamik veri için ScrollView kesin yasak
- .map() ile liste render edilmez

Tercih sırası:
1) FlashList
2) FlatList
3) SectionList

================================================================================
## 8) PAGINATION + INFINITE SCROLL (ZORUNLU)

- Pagination sadece TanStack Query useInfiniteQuery ile yapılır
- Pagination state screen’de tutulmaz
- Aynı anda birden fazla fetch yasak
- Listeye yeni sayfa EKLENEREK ilerlenir
- Pagination logic sadece hook içindedir

================================================================================
## 9) INFINITE QUERY HOOK STANDARDI

- initialPageParam zorunlu
- getNextPageParam zorunlu
- hasNextPage + isFetchingNextPage guard zorunlu
- Liste birleştirme hook içinde yapılır

================================================================================
## 10) ANDROID SAFE LIST KURALLARI

- Row component memo ile sarılır
- renderItem useCallback ile memo’lanır
- keyExtractor zorunludur
- FlashList kullanılıyorsa estimatedItemSize zorunludur
- Tek scroll container kullanılır
- Render içinde console.log yasaktır

================================================================================
## 11) SCREEN STANDARDI

- Screen sadece composition yapar
- Loader / Empty / Error state render eder
- Liste component’e sadece data ve handler’ları verir
- Pagination logic içermez

================================================================================
## 12) i18n STANDARDI

- Tüm metinler t("key") ile gelir
- Hardcoded string yasaktır
- Dil dosyaları locales/ altında tutulur

================================================================================
## 13) İSİMLENDİRME

- Klasör: kebab-case
- Component: PascalCase
- Hook: useXxx
- Type / Interface: PascalCase
- Constants: UPPER_SNAKE_CASE

================================================================================
## 14) ANDROID DONMA / KİTLENME ÖNLEME (ZORUNLU)

- Uzun listeler ScrollView ile yapılmaz
- Büyük listeler FlashList tercih eder
- Filtre/sort işlemleri render içinde yapılmaz
- Search input debounce edilir
- Gereksiz re-render engellenir
- Tek scroll view kullanılır

================================================================================
## 15) SON SÖZ

Bu kurallara uymayan kod kabul edilmez.
Cursor bu dosyayı TEK KAYNAK olarak kabul eder.
